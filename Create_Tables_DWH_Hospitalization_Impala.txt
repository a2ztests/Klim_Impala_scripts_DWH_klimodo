DROP TABLE IF EXISTS dwh.Dim_Med_Visit_Patient_Visit;
create external table dwh.Dim_Med_Visit_Patient_Visit (

med_visit_GK string,
original_visit_number string,
visit_start_date string,
visit_start_time string,
visit_end_date string,
visit_end_time string,
release_ind string,
institute_GK string,
institute_MBR_code string,
institute_longitude string,
institute_latitude string,
patient_type_GK string,
patient_type_code string,
patient_type_group_code string,
patient_GK string,
patient_ID string,
patient_ID_type string,
birth_year string,
patient_age string,
patient_age_GK string,
patient_city_GK string,
patient_city_code string,
patient_city_longitude string,
patient_city_latitude string,
patient_visit_reason_GK string,
patient_visit_reason_code string,
patient_visit_reason_group_code string,
patient_visit_reason_sub_group_code string,
patient_referrer_GK string,
patient_referrer_code string,
insurer_GK string,
insurer_code string,
paying_entity_GK string,
paying_entity_code string,
patient_visit_type_GK string,
patient_visit_type_code string,
patient_release_type_GK string,
patient_release_type_code string,
patient_release_type_group_code string,
admission_dept_GK string,
admission_dept_code string,
discharge_dept_GK string,
discharge_dept_code string,
hosp_dept_from_ER_GK string,
hosp_dept_from_ER_code string,
ER_delivery_room_ind string,
destination_GK string,
destination_code string,
source_institute_GK string,
source_institute string,
destination_institute_GK string,
destination_institute string,
total_stay_days string,
death_diagnosis_GK string,
death_diagnosis_code string,
gestational_week_code string,
birth_weight string,
ETL_insert_date_time string,
source_type_GK string,
source_type_code string,
ETL_process_code string,
ETL_update_date_time string,
Birth_Country_GK string,
Birth_Country_Code string,
delete_date_time string,
Arrival_Manner string,
Arrival_Manner_GK string,
gender_code string,
mother_hospitalization_id string,
family_status string,
ICD9_First_Diagnostic_code string,
ICD9_Second_Diagnostic_code string,
ICD9_Third_Diagnostic_code string,
 
avrofilename string, 
avroschemacha1 string, 
avroschemafilename string, 
filesize bigint,
createtimelong bigint, 
record_type string, 
namespace string, 
sessionid  string)
  
  
row format delimited
fields terminated by ','
location '/user/amir.shaked/klimodo/Dim_Med_Visit_Patient_Visit';


--++++++++++++++++
DROP TABLE IF EXISTS dwh.Fact_Med_Visit_Patient_Visit_Diagnostics;
create external table dwh.Fact_Med_Visit_Patient_Visit_Diagnostics (

Original_Visit_Number string,
Visit_GK string,
Patient_Type_GK string,
Patient_Age_GK string,
Patient_Visit_Reason_GK string,
Insurer_GK string,
Patient_Visit_Type_GK string,
Patient_Release_Type_GK string,
patient_referrer_GK string,
Patient_GK string,
patient_city_GK string,
destination_GK string,
paying_entity_GK string,
department_code string,
institute_Dept_GK string,
Visit_Start_Date string,
Visit_Start_Time string,
Visit_End_Date string,
Visit_End_Time string,
Dept_Entry_Date string,
Dept_Release_Date string,
Dept_Entry_Hour string,
Dept_Release_Hour string,
Institute_mbr_Code string,
is_last_dept_ind string,
ICD9_First_Diagnostic_code string,
First_Diagnostic_Date string,
ICD9_Secondary_Diagnostic_code string,
ICD9_Secondary_Diagnostic_type_GK string,
ICD9_Secondary_Diagnostic_type string,
Secondary_Diagnostic_Date string,
source_type_GK string,
Source_Type_Code string,
ETL_insert_date_time string,
ETL_process_code string,
ETL_update_date_time string,
ETL_delete_date_time string,
arrival_manner_gk string,
Department_Enumerator string,

avrofilename string, 
avroschemacha1 string, 
avroschemafilename string, 
filesize bigint,
createtimelong bigint, 
record_type string, 
namespace string, 
sessionid  string)
  
  
row format delimited
fields terminated by ','
location '/user/amir.shaked/klimodo/Fact_Med_Visit_Patient_Visit_Diagnostics';
  
--++++++++++++++++
DROP TABLE IF EXISTS dwh.Fact_Med_Visit_Patient_Visit_Events;
create external table dwh.Fact_Med_Visit_Patient_Visit_Events (

med_visit_GK string,
original_visit_number string,
department_entry_date string,
department_entry_time string,
department_exit_date string,
department_exit_time string,
visit_start_date string,
visit_end_date string,
institute_GK string,
institute_MBR_code string,
patient_type_GK string,
patient_type_code string,
patient_type_group_code string,
patient_GK string,
patient_ID string,
patient_ID_type string,
patient_age string,
patient_age_GK string,
city_GK string,
city_code string,
patient_visit_reason_GK string,
patient_visit_reason_code string,
patient_visit_reason_sub_group_code string,
patient_referrer_GK string,
patient_referrer_code string,
insurer_GK string,
insurer_code string,
paying_entity_GK string,
paying_entity_code string,
patient_visit_type_GK string,
patient_visit_type_code string,
patient_release_type_GK string,
patient_release_type_code string,
patient_release_type_group_code string,
patient_hospitalizing_department_GK string,
patient_hospitalizing_department_code string,
transferred_to_dept_GK string,
transferred_to_dept_code string,
is_last_department string,
department_enumerator string,
destination_GK string,
destination_code string,
first_diagnosis string,
first_operation string,
first_operation_date string,
death_diagnosis_code string,
total_vacation_days string,
stay_hosp_days string,
stay_ER_minutes string,
total_hospitalization_days string,
ER_Visit_Groups_Code string,
ER_Visit_Groups_GK string,
gestational_week_code string,
birth_weight string,
diag_ratio_visit string,
diag_ratio_dept string,
diag_ratio_last_dept string,
diag_ratio_visit_denominator string,
diag_ratio_dept_denominator string,
diag_ratio_last_dept_denominator string,
ETL_insert_date_time string,
source_type_GK string,
source_type_code string,
ETL_process_code string,
ETL_update_date_time string,
delete_date_time string,

avrofilename string, 
avroschemacha1 string, 
avroschemafilename string, 
filesize bigint,
createtimelong bigint, 
record_type string, 
namespace string, 
sessionid  string)

 
row format delimited
fields terminated by ','
location '/user/amir.shaked/klimodo/Fact_Med_Visit_Patient_Visit_Events';

--++++++++++++++++
DROP TABLE IF EXISTS dwh.Fact_Med_Visit_Patient_Visit_Operations;
create external table dwh.Fact_Med_Visit_Patient_Visit_Operations (

Original_Visit_Number string,
Visit_GK string,
Patient_Type_GK string,
Patient_Age_GK string,
Patient_Visit_Reason_GK string,
Insurer_GK string,
Patient_Visit_Type_GK string,
Patient_Release_Type_GK string,
patient_referrer_GK string,
Patient_GK string,
patient_city_GK string,
destination_GK string,
paying_entity_GK string,
department_code string,
institute_Dept_GK string,
Visit_Start_Date string,
Visit_Start_Time string,
Visit_End_Date string,
Visit_End_Time string,
Dept_Entry_Date string,
Dept_Release_Date string,
Dept_Entry_Hour string,
Dept_Release_Hour string,
Institute_mbr_Code string,
ICD9_First_Operation_code string,
First_Operation_Date string,
ICD9_Secondary_Operation_code string,
ICD9_Secondary_Operation_type_GK string,
ICD9_Secondary_Operation_type string,
Secondary_Operation_Date string,
source_type_GK string,
Source_Type_Code string,
ETL_insert_date_time string,
ETL_process_code string,
ETL_update_date_time string,
ETL_delete_date_time string,

avrofilename string, 
avroschemacha1 string, 
avroschemafilename string, 
filesize bigint,
createtimelong bigint, 
record_type string, 
namespace string, 
sessionid  string)


  
  row format delimited
  fields terminated by ','
 location '/user/amir.shaked/klimodo/Fact_Med_Visit_Patient_Visit_Operations';


--++++++++++++++++
